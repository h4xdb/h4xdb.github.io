<script>
document.write(unescape('%3C%21DOCTYPE%20html%3E%0A%3Chtml%20lang%3D%22en%22%3E%0A%3Chead%3E%0A%20%20%3Cmeta%20charset%3D%22UTF-8%22%20/%3E%0A%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%20initial-scale%3D1.0%22/%3E%0A%20%20%3Ctitle%3EHome%20Automation%3C/title%3E%0A%20%20%3Cscript%20src%3D%22https%3A//www.gstatic.com/firebasejs/8.10.0/firebase-app.js%22%3E%3C/script%3E%0A%20%20%3Cscript%20src%3D%22https%3A//www.gstatic.com/firebasejs/8.10.0/firebase-auth.js%22%3E%3C/script%3E%0A%20%20%3Cscript%20src%3D%22https%3A//www.gstatic.com/firebasejs/8.10.0/firebase-database.js%22%3E%3C/script%3E%0A%20%20%3Cstyle%3E%0A%20%20%20%20body%20%7B%0A%20%20%20%20%20%20font-family%3A%20%27Segoe%20UI%27%2C%20sans-serif%3B%0A%20%20%20%20%20%20margin%3A%200%3B%0A%20%20%20%20%20%20padding%3A%200%3B%0A%20%20%20%20%20%20background%3A%20%23f0f2f5%3B%0A%20%20%20%20%20%20display%3A%20flex%3B%0A%20%20%20%20%20%20justify-content%3A%20center%3B%0A%20%20%20%20%20%20align-items%3A%20center%3B%0A%20%20%20%20%20%20min-height%3A%20100vh%3B%0A%20%20%20%20%7D%0A%20%20%20%20.card%20%7B%0A%20%20%20%20%20%20background%3A%20%23fff%3B%0A%20%20%20%20%20%20padding%3A%2030px%3B%0A%20%20%20%20%20%20border-radius%3A%2012px%3B%0A%20%20%20%20%20%20box-shadow%3A%200%204px%2020px%20rgba%280%2C0%2C0%2C0.1%29%3B%0A%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20max-width%3A%20400px%3B%0A%20%20%20%20%20%20text-align%3A%20center%3B%0A%20%20%20%20%7D%0A%20%20%20%20h2%2C%20h4%20%7B%0A%20%20%20%20%20%20color%3A%20%23333%3B%0A%20%20%20%20%7D%0A%20%20%20%20input%20%7B%0A%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20padding%3A%2012px%3B%0A%20%20%20%20%20%20margin-bottom%3A%2015px%3B%0A%20%20%20%20%20%20border%3A%201px%20solid%20%23ccc%3B%0A%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20font-size%3A%2016px%3B%0A%20%20%20%20%7D%0A%20%20%20%20button%20%7B%0A%20%20%20%20%20%20width%3A%20100%25%3B%0A%20%20%20%20%20%20padding%3A%2012px%3B%0A%20%20%20%20%20%20font-size%3A%2016px%3B%0A%20%20%20%20%20%20border%3A%20none%3B%0A%20%20%20%20%20%20border-radius%3A%208px%3B%0A%20%20%20%20%20%20margin-bottom%3A%2010px%3B%0A%20%20%20%20%20%20cursor%3A%20pointer%3B%0A%20%20%20%20%20%20background-color%3A%20%23007bff%3B%0A%20%20%20%20%20%20color%3A%20white%3B%0A%20%20%20%20%20%20transition%3A%20background-color%200.2s%20ease%3B%0A%20%20%20%20%7D%0A%20%20%20%20button%3Ahover%20%7B%0A%20%20%20%20%20%20background-color%3A%20%230056b3%3B%0A%20%20%20%20%7D%0A%20%20%20%20.secondary%20%7B%0A%20%20%20%20%20%20background-color%3A%20%236c757d%3B%0A%20%20%20%20%7D%0A%20%20%20%20.secondary%3Ahover%20%7B%0A%20%20%20%20%20%20background-color%3A%20%235a6268%3B%0A%20%20%20%20%7D%0A%20%20%20%20.status%20%7B%0A%20%20%20%20%20%20font-weight%3A%20bold%3B%0A%20%20%20%20%20%20font-size%3A%2016px%3B%0A%20%20%20%20%7D%0A%20%20%20%20.on%20%7B%20color%3A%20green%3B%20%7D%0A%20%20%20%20.off%20%7B%20color%3A%20red%3B%20%7D%0A%20%20%20%20.hidden%20%7B%20display%3A%20none%3B%20%7D%0A%20%20%20%20.topbar%20%7B%0A%20%20%20%20%20%20position%3A%20absolute%3B%0A%20%20%20%20%20%20top%3A%2020px%3B%0A%20%20%20%20%20%20right%3A%2020px%3B%0A%20%20%20%20%7D%0A%20%20%20%20.topbar%20button%20%7B%0A%20%20%20%20%20%20width%3A%20auto%3B%0A%20%20%20%20%20%20padding%3A%206px%2012px%3B%0A%20%20%20%20%7D%0A%20%20%3C/style%3E%0A%3C/head%3E%0A%3Cbody%3E%0A%20%20%3Cdiv%20class%3D%22topbar%20hidden%22%20id%3D%22settingsBtnWrap%22%3E%0A%20%20%20%20%3Cbutton%20onclick%3D%22showSettings%28%29%22%3ESettings%3C/button%3E%0A%20%20%3C/div%3E%0A%0A%20%20%3C%21--%20Login%20Card%20--%3E%0A%20%20%3Cdiv%20id%3D%22loginCard%22%20class%3D%22card%22%3E%0A%20%20%20%20%3Ch2%3E%uD83D%uDD10%20Login%20to%20Control%20Your%20Home%3C/h2%3E%0A%20%20%20%20%3Cinput%20type%3D%22email%22%20id%3D%22email%22%20placeholder%3D%22Email%20address%22%20/%3E%0A%20%20%20%20%3Cinput%20type%3D%22password%22%20id%3D%22password%22%20placeholder%3D%22Password%22%20/%3E%0A%20%20%20%20%3Cbutton%20onclick%3D%22login%28%29%22%3ELogin%3C/button%3E%0A%20%20%20%20%3Cbutton%20class%3D%22secondary%22%20onclick%3D%22signup%28%29%22%3ESign%20Up%3C/button%3E%0A%20%20%3C/div%3E%0A%0A%20%20%3C%21--%20Control%20Panel%20--%3E%0A%20%20%3Cdiv%20id%3D%22controlCard%22%20class%3D%22card%20hidden%22%3E%3C/div%3E%0A%0A%20%20%3C%21--%20Settings%20Panel%20--%3E%0A%20%20%3Cdiv%20id%3D%22settingsCard%22%20class%3D%22card%20hidden%22%3E%0A%20%20%20%20%3Ch2%3E%u2699%uFE0F%20Settings%3C/h2%3E%0A%20%20%20%20%3Ch4%3EWiFi%20Scan%3C/h4%3E%0A%20%20%20%20%3Cbutton%20onclick%3D%22rescanWiFi%28%29%22%3ERescan%3C/button%3E%0A%20%20%20%20%3Cdiv%20id%3D%22wifi-section%22%3E%0A%20%20%20%20%20%20%3Cdiv%20id%3D%22wifi-list%22%20style%3D%22margin-top%3A%2010px%3B%22%3E%3C/div%3E%0A%20%20%20%20%20%20%3Cdiv%20style%3D%22margin-top%3A%2020px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22text%22%20id%3D%22selected-ssid%22%20placeholder%3D%22Selected%20SSID%22%20readonly%20/%3E%0A%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22password%22%20id%3D%22wifi-password%22%20placeholder%3D%22WiFi%20Password%22%20/%3E%0A%20%20%20%20%20%20%20%20%3Cbutton%20onclick%3D%22connectWiFi%28%29%22%3EConnect%3C/button%3E%0A%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%3Cdiv%20id%3D%22admin-section%22%20class%3D%22hidden%22%20style%3D%22margin-top%3A%2030px%3B%22%3E%0A%20%20%20%20%20%20%3Ch4%3EAdmin%20-%20Add%20User%3C/h4%3E%0A%20%20%20%20%20%20%3Cinput%20type%3D%22email%22%20id%3D%22new-user-email%22%20placeholder%3D%22New%20user%20email%22%20/%3E%0A%20%20%20%20%20%20%3Cbutton%20onclick%3D%22addAllowedUser%28%29%22%3EAdd%3C/button%3E%0A%0A%20%20%20%20%20%20%3Ch4%20style%3D%22margin-top%3A%2030px%3B%22%3EAdmin%20-%20OTA%20Update%3C/h4%3E%0A%20%20%20%20%20%20%3Cinput%20type%3D%22text%22%20id%3D%22ota-url%22%20placeholder%3D%22Firmware%20.bin%20URL%22%20/%3E%0A%20%20%20%20%20%20%3Cbutton%20onclick%3D%22triggerOTA%28%29%22%3EStart%20OTA%20Update%3C/button%3E%0A%0A%20%20%20%20%20%20%3Ch4%20style%3D%22margin-top%3A%2030px%3B%22%3EAdmin%20-%20Link%20User%20to%20Device%3C/h4%3E%0A%20%20%20%20%20%20%3Cinput%20type%3D%22email%22%20id%3D%22link-user-email%22%20placeholder%3D%22User%20email%22%20/%3E%0A%20%20%20%20%20%20%3Cinput%20type%3D%22text%22%20id%3D%22link-device-id%22%20placeholder%3D%22Device%20ID%20%28e.g.%20device1%29%22%20/%3E%0A%20%20%20%20%20%20%3Cbutton%20onclick%3D%22linkUserToDevice%28%29%22%3ELink%3C/button%3E%0A%20%20%20%20%3C/div%3E%0A%20%20%20%20%3Cbutton%20class%3D%22secondary%22%20onclick%3D%22backToControl%28%29%22%20style%3D%22margin-top%3A%2020px%3B%22%3EBack%3C/button%3E%0A%20%20%3C/div%3E%0A%0A%20%20%3Cscript%3E%0A%20%20%20%20const%20firebaseConfig%20%3D%20%7B%0A%20%20%20%20%20%20apiKey%3A%20%22AIzaSyBTsypZYdo6spPGG9W9MEeckgcetefDP3M%22%2C%0A%20%20%20%20%20%20authDomain%3A%20%22h4xcontrol.firebaseapp.com%22%2C%0A%20%20%20%20%20%20databaseURL%3A%20%22https%3A//h4xcontrol-default-rtdb.firebaseio.com%22%2C%0A%20%20%20%20%20%20projectId%3A%20%22h4xcontrol%22%2C%0A%20%20%20%20%20%20storageBucket%3A%20%22h4xcontrol.appspot.com%22%2C%0A%20%20%20%20%20%20messagingSenderId%3A%20%221030967330576%22%2C%0A%20%20%20%20%20%20appId%3A%20%221%3A1030967330576%3Aweb%3Aac3e4201a61b5bebea8795%22%2C%0A%20%20%20%20%20%20measurementId%3A%20%22G-Z20VN8LY3N%22%0A%20%20%20%20%7D%3B%0A%20%20%20%20firebase.initializeApp%28firebaseConfig%29%3B%0A%20%20%20%20const%20auth%20%3D%20firebase.auth%28%29%3B%0A%20%20%20%20const%20db%20%3D%20firebase.database%28%29%3B%0A%20%20%20%20const%20allowedEmailsPath%20%3D%20%27allowed_users%27%3B%0A%20%20%20%20const%20adminEmail%20%3D%20%22contact@hashir.site%22%3B%0A%20%20%20%20let%20currentUser%20%3D%20null%3B%0A%20%20%20%20let%20linkedDevices%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20auth.onAuthStateChanged%28user%20%3D%3E%20%7B%0A%20%20%20%20%20%20currentUser%20%3D%20user%3B%0A%20%20%20%20%20%20if%20%28user%29%20%7B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22loginCard%22%29.classList.add%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22settingsBtnWrap%22%29.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20checkAdmin%28%29%3B%0A%20%20%20%20%20%20%20%20loadLinkedDevices%28%29%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22loginCard%22%29.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22controlCard%22%29.classList.add%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22settingsBtnWrap%22%29.classList.add%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20function%20login%28%29%20%7B%0A%20%20%20%20%20%20const%20email%20%3D%20document.getElementById%28%22email%22%29.value%3B%0A%20%20%20%20%20%20const%20pass%20%3D%20document.getElementById%28%22password%22%29.value%3B%0A%20%20%20%20%20%20auth.signInWithEmailAndPassword%28email%2C%20pass%29.catch%28e%20%3D%3E%20alert%28e.message%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20signup%28%29%20%7B%0A%20%20%20%20%20%20const%20email%20%3D%20document.getElementById%28%22email%22%29.value%3B%0A%20%20%20%20%20%20const%20pass%20%3D%20document.getElementById%28%22password%22%29.value%3B%0A%20%20%20%20%20%20db.ref%28allowedEmailsPath%29.once%28%27value%27%29.then%28snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20allowed%20%3D%20snap.val%28%29%20%7C%7C%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21allowed%5Bemail.replace%28%27.%27%2C%20%27%2C%27%29%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20alert%28%22%u26D4%20This%20email%20is%20not%20allowed%20to%20register.%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20auth.createUserWithEmailAndPassword%28email%2C%20pass%29.catch%28e%20%3D%3E%20alert%28e.message%29%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20logout%28%29%20%7B%20auth.signOut%28%29%3B%20%7D%0A%0A%20%20%20%20function%20loadLinkedDevices%28%29%20%7B%0A%20%20%20%20%20%20const%20safeEmail%20%3D%20currentUser.email.replace%28%27.%27%2C%20%27%2C%27%29%3B%0A%20%20%20%20%20%20db.ref%28%60users_devices/%24%7BsafeEmail%7D%60%29.once%28%27value%27%29.then%28snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20linkedDevices%20%3D%20snap.val%28%29%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20renderDeviceControls%28%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20renderDeviceControls%28%29%20%7B%0A%20%20%20%20%20%20const%20controlCard%20%3D%20document.getElementById%28%22controlCard%22%29%3B%0A%20%20%20%20%20%20controlCard.innerHTML%20%3D%20%60%3Ch2%3E%uD83C%uDFE0%20Home%20Control%20Panel%3C/h2%3E%3Cdiv%20id%3D%22devices-container%22%3E%3C/div%3E%3Cbutton%20class%3D%22secondary%22%20onclick%3D%22logout%28%29%22%20style%3D%22margin-top%3A20px%3B%22%3ELogout%3C/button%3E%60%3B%0A%20%20%20%20%20%20const%20container%20%3D%20document.getElementById%28%22devices-container%22%29%3B%0A%20%20%20%20%20%20if%20%28linkedDevices.length%20%3D%3D%3D%200%29%20return%20container.innerHTML%20%3D%20%22%3Cp%3ENo%20linked%20devices%20found.%3C/p%3E%22%3B%0A%0A%20%20%20%20%20%20linkedDevices.forEach%28deviceId%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20let%20html%20%3D%20%60%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin-bottom%3A%2030px%3B%20border%3A%201px%20solid%20%23eee%3B%20padding%3A%2015px%3B%20border-radius%3A%2010px%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Ch4%3EDevice%3A%20%24%7BdeviceId%7D%3C/h4%3E%60%3B%0A%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%3D%206%3B%20i++%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20html%20+%3D%20%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cp%3ELamp%20%24%7Bi%7D%3A%20%3Cspan%20id%3D%22%24%7BdeviceId%7D-lamp%24%7Bi%7D-status%22%20class%3D%22status%22%3E...%3C/span%3E%3C/p%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick%3D%22toggleLamp%28%27%24%7BdeviceId%7D%27%2C%20%27lamp%24%7Bi%7D%27%29%22%3EToggle%20Lamp%20%24%7Bi%7D%3C/button%3E%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20html%20+%3D%20%60%0A%20%20%20%20%20%20%20%20%20%20%3Cp%3EStatus%3A%20%3Cspan%20id%3D%22%24%7BdeviceId%7D-status%22%20class%3D%22status%22%3EChecking...%3C/span%3E%3C/p%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%60%3B%0A%0A%20%20%20%20%20%20%20%20container.insertAdjacentHTML%28%22beforeend%22%2C%20html%29%3B%0A%0A%20%20%20%20%20%20%20%20for%20%28let%20i%20%3D%201%3B%20i%20%3C%3D%206%3B%20i++%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20updateStatus%28deviceId%2C%20%60lamp%24%7Bi%7D%60%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20trackOnlineStatus%28deviceId%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20controlCard.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20updateStatus%28deviceId%2C%20lamp%29%20%7B%0A%20%20%20%20%20%20const%20el%20%3D%20document.getElementById%28%60%24%7BdeviceId%7D-%24%7Blamp%7D-status%60%29%3B%0A%20%20%20%20%20%20db.ref%28%60devices/%24%7BdeviceId%7D/%24%7Blamp%7D%60%29.on%28%27value%27%2C%20snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20val%20%3D%20snap.val%28%29%3B%0A%20%20%20%20%20%20%20%20el.textContent%20%3D%20val%20%3F%20%22ON%22%20%3A%20%22OFF%22%3B%0A%20%20%20%20%20%20%20%20el.className%20%3D%20%60status%20%24%7Bval%20%3F%20%27on%27%20%3A%20%27off%27%7D%60%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20toggleLamp%28deviceId%2C%20lamp%29%20%7B%0A%20%20%20%20%20%20const%20ref%20%3D%20db.ref%28%60devices/%24%7BdeviceId%7D/%24%7Blamp%7D%60%29%3B%0A%20%20%20%20%20%20ref.once%28%27value%27%29.then%28snap%20%3D%3E%20ref.set%28%21snap.val%28%29%29%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trackOnlineStatus%28deviceId%29%20%7B%0A%20%20%20%20%20%20const%20statusEl%20%3D%20document.getElementById%28%60%24%7BdeviceId%7D-status%60%29%3B%0A%20%20%20%20%20%20db.ref%28%60devices/%24%7BdeviceId%7D/status/online%60%29.on%28%27value%27%2C%20snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20isOnline%20%3D%20snap.val%28%29%3B%0A%20%20%20%20%20%20%20%20statusEl.textContent%20%3D%20isOnline%20%3F%20%22Online%22%20%3A%20%22Offline%22%3B%0A%20%20%20%20%20%20%20%20statusEl.className%20%3D%20%60status%20%24%7BisOnline%20%3F%20%27on%27%20%3A%20%27off%27%7D%60%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20showSettings%28%29%20%7B%0A%20%20%20%20%20%20document.getElementById%28%22controlCard%22%29.classList.add%28%22hidden%22%29%3B%0A%20%20%20%20%20%20document.getElementById%28%22settingsCard%22%29.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20backToControl%28%29%20%7B%0A%20%20%20%20%20%20document.getElementById%28%22controlCard%22%29.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%20%20document.getElementById%28%22settingsCard%22%29.classList.add%28%22hidden%22%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20rescanWiFi%28%29%20%7B%0A%20%20%20%20%20%20db.ref%28%22wifi/scan%22%29.set%28true%29%3B%0A%20%20%20%20%20%20db.ref%28%22wifi/networks%22%29.once%28%22value%22%2C%20snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20list%20%3D%20document.getElementById%28%22wifi-list%22%29%3B%0A%20%20%20%20%20%20%20%20list.innerHTML%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20snap.val%28%29%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20data.forEach%28ssid%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20btn%20%3D%20document.createElement%28%22button%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20btn.textContent%20%3D%20ssid%3B%0A%20%20%20%20%20%20%20%20%20%20btn.style.width%20%3D%20%22100%25%22%3B%0A%20%20%20%20%20%20%20%20%20%20btn.style.marginBottom%20%3D%20%228px%22%3B%0A%20%20%20%20%20%20%20%20%20%20btn.onclick%20%3D%20%28%29%20%3D%3E%20document.getElementById%28%22selected-ssid%22%29.value%20%3D%20ssid%3B%0A%20%20%20%20%20%20%20%20%20%20list.appendChild%28btn%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20connectWiFi%28%29%20%7B%0A%20%20%20%20%20%20const%20ssid%20%3D%20document.getElementById%28%22selected-ssid%22%29.value%3B%0A%20%20%20%20%20%20const%20pass%20%3D%20document.getElementById%28%22wifi-password%22%29.value%3B%0A%20%20%20%20%20%20if%20%28%21ssid%20%7C%7C%20%21pass%29%20return%20alert%28%22Enter%20SSID%20and%20password%22%29%3B%0A%20%20%20%20%20%20db.ref%28%22wifi/credentials%22%29.set%28%7B%20ssid%2C%20password%3A%20pass%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20addAllowedUser%28%29%20%7B%0A%20%20%20%20%20%20const%20email%20%3D%20document.getElementById%28%22new-user-email%22%29.value%3B%0A%20%20%20%20%20%20if%20%28%21email%29%20return%3B%0A%20%20%20%20%20%20const%20safeEmail%20%3D%20email.replace%28%27.%27%2C%20%27%2C%27%29%3B%0A%20%20%20%20%20%20db.ref%28%60%24%7BallowedEmailsPath%7D/%24%7BsafeEmail%7D%60%29.set%28true%29.then%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20alert%28%22User%20added%20to%20allowed%20list%22%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22new-user-email%22%29.value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20checkAdmin%28%29%20%7B%0A%20%20%20%20%20%20if%20%28currentUser%20%26%26%20currentUser.email%20%3D%3D%3D%20adminEmail%29%20%7B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22admin-section%22%29.classList.remove%28%22hidden%22%29%3B%0A%20%20%20%20%20%20%20%20db.ref%28%22ota/url%22%29.once%28%22value%22%29.then%28snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20const%20val%20%3D%20snap.val%28%29%3B%0A%20%20%20%20%20%20%20%20%20%20if%20%28val%29%20document.getElementById%28%22ota-url%22%29.value%20%3D%20val%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20triggerOTA%28%29%20%7B%0A%20%20%20%20%20%20const%20url%20%3D%20document.getElementById%28%22ota-url%22%29.value%3B%0A%20%20%20%20%20%20if%20%28%21url%29%20return%20alert%28%22Please%20enter%20a%20valid%20.bin%20file%20URL%22%29%3B%0A%20%20%20%20%20%20db.ref%28%22ota%22%29.set%28%7B%20update%3A%20true%2C%20url%20%7D%29.then%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20alert%28%22%uD83D%uDE80%20OTA%20update%20triggered.%20Device%20will%20update%20shortly.%22%29%3B%0A%20%20%20%20%20%20%20%20document.getElementById%28%22ota-url%22%29.value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%7D%29.catch%28err%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20alert%28%22%u26A0%uFE0F%20Failed%20to%20trigger%20OTA%3A%20%22%20+%20err.message%29%3B%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20linkUserToDevice%28%29%20%7B%0A%20%20%20%20%20%20const%20email%20%3D%20document.getElementById%28%22link-user-email%22%29.value%3B%0A%20%20%20%20%20%20const%20deviceId%20%3D%20document.getElementById%28%22link-device-id%22%29.value%3B%0A%20%20%20%20%20%20if%20%28%21email%20%7C%7C%20%21deviceId%29%20return%20alert%28%22Enter%20both%20email%20and%20device%20ID%22%29%3B%0A%20%20%20%20%20%20const%20safeEmail%20%3D%20email.replace%28%27.%27%2C%20%27%2C%27%29%3B%0A%20%20%20%20%20%20const%20ref%20%3D%20db.ref%28%60users_devices/%24%7BsafeEmail%7D%60%29%3B%0A%20%20%20%20%20%20ref.once%28%27value%27%29.then%28snap%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20devices%20%3D%20snap.val%28%29%20%7C%7C%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20if%20%28%21devices.includes%28deviceId%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20devices.push%28deviceId%29%3B%0A%20%20%20%20%20%20%20%20%20%20ref.set%28devices%29.then%28%28%29%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert%28%22User%20linked%20to%20device%20successfully%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById%28%22link-user-email%22%29.value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20document.getElementById%28%22link-device-id%22%29.value%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20alert%28%22User%20is%20already%20linked%20to%20this%20device%22%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%20%20%3C/script%3E%0A%0A%20%20%3Cfooter%20style%3D%22position%3A%20fixed%3B%20bottom%3A%2010px%3B%20width%3A%20100%25%3B%20text-align%3A%20center%3B%20font-size%3A%2014px%3B%20color%3A%20%23888%3B%22%3E%0A%20%20%20%20%A9%202025%20%3Cstrong%3Eby%20Hashir%u2122%3C/strong%3E%20%u2014%20All%20rights%20reserved.%0A%20%20%3C/footer%3E%0A%3C/body%3E%0A%3C/html%3E%0A'));
</script>
